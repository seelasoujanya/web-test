<div class="bg-container">
  <div class="details-label">
    <div class="label-left">
      <button
        class="navigate-back-btn"
        type="button"
        (click)="backToWorkflows()">
        <img
          src="/assets/icons/navigate-back-logo.svg"
          class="navigate-back-icon"
          alt="export Icon" />
      </button>
      <div>{{ templateName }}</div>
    </div>
  </div>

  <div class="main-container">
    <div class="header">
      <p>Template Details</p>
      <div class="general-setting-label">
        <div class="buttons" *ngIf="detailEditing">
          <button
            class="save-btn"
            (click)="updateTemplateDetails()"
            type="button">
            save
          </button>
          <button
            class="cancel-btn"
            (click)="toggleDetailEditig()"
            type="button">
            cancel
          </button>
        </div>
        <div class="edit-icon">
          <img
            src="/assets/icons/edit-icon.svg"
            alt="edit Icon"
            (click)="toggleDetailEditig()" />
        </div>
      </div>
    </div>

    <div class="fields-container">
      <div class="field-item">
        <span>Name</span>
        <input
          type="text"
          maxlength="255"
          placeholder="Name"
          class="input-field"
          [(ngModel)]="templateName"
          [disabled]="!detailEditing" />
      </div>

      <div class="field-item">
        <span>Description</span>
        <input
          type="text"
          maxlength="255"
          placeholder="Description"
          class="input-field"
          [(ngModel)]="templateDescription"
          [disabled]="!detailEditing" />
      </div>
    </div>
  </div>

  <div class="templates-container">
    <div class="left-container">
      <div class="heading">
        <p class="label">History</p>
      </div>
      <div
        *ngFor="let template of xmlTemplatesById; let i = index"
        [ngClass]="{ 'selected-version': i === selectedTemplateIndex }"
        class="version"
        (click)="selectTemplate(i)">
        <div class="version-number">
          {{ template?.displayName }}
        </div>
        <div class="time">
          {{ template.created | date: 'MMM, dd YYYY HH:mm' }}
        </div>
      </div>
    </div>
    <div class="right-container">
      <div class="heading">
        <!-- <p class="label">{{ templateName }}</p> -->
        <div class="buttons">
          <button class="edit-btn" (click)="isEditableTemplate()">
            <img
              src="/assets/icons/edit-icon.svg"
              alt="export Icon"
              class="edit-icon" />
          </button>
          <!-- <button
          class="compare-btn"
          (click)="openCompareDialog(compareTemplateForm)">
          Compare
        </button> -->
          <button
            class="save-as-btn"
            [disabled]="!enableEditing"
            [ngClass]="{ 'not-allowed': !enableEditing }"
            (click)="editTemplate()">
            Save
          </button>
        </div>
      </div>
      <div class="template">
        <form [formGroup]="reactiveForm" class="form">
          <!-- To change this height style.scss .CodeMirror -->
          <ngx-codemirror
            [options]="editorOptions"
            name="code"
            id="code"
            formControlName="code"
            [disabled]="!enableEditing"></ngx-codemirror>
        </form>
      </div>
    </div>
  </div>

  <ng-template #compareTemplateForm class="modal-content">
    <div class="header">
      <p class="header_title">Compare Changes</p>
      <button type="button" class="header_close-btn" (click)="closeModal()">
        <img src="assets/icons/close-circle.svg" alt="" />
      </button>
    </div>
    <div class="form-details">
      <div class="select-templates">
        <ng-select
          [items]="xmlTemplatesById"
          bindLabel="displayName"
          bindValue="templateCode"
          placeholder="Select First Template"
          [searchable]="false"
          [clearable]="false"
          [(ngModel)]="compareTemplate.firstTemplate"
          class="input-field"
          (change)="selectFirstTemplate($event)">
        </ng-select>
        <ng-select
          [items]="xmlTemplatesById"
          bindLabel="displayName"
          bindValue="templateCode"
          placeholder="Select Second Template"
          [searchable]="false"
          [clearable]="false"
          [(ngModel)]="compareTemplate.secondTemplate"
          class="input-field"
          (change)="selectSecondTemplate($event)">
        </ng-select>
      </div>
    </div>

    <div class="compareTemplates" *ngIf="showDifferences">
      <form class="diff-editor-form"></form>
    </div>
    <div class="buttons">
      <button class="cancel-btn" (click)="closeModal()">CANCEL</button>
      <button class="confirm-btn" (click)="compareChanges()">COMPARE</button>
    </div>
  </ng-template>
</div>
